## 전략 패턴

```java

// 1. Strategy 인터페이스
public interface PaymentStrategy {
    void pay(int amount);
}

// 2. Concrete Strategy (구체 전략 클래스)
public class CreditCardPayment implements PaymentStrategy {
    @Override
    public void pay(int amount) {
        System.out.println(amount + "원을 신용카드로 결제합니다.");
    }
}

public class KakaoPayPayment implements PaymentStrategy {
    @Override
    public void pay(int amount) {
        System.out.println(amount + "원을 카카오페이로 결제합니다.");
    }
}

// 3. Context 클래스 (전략을 사용하는 곳)
public class PaymentService {
    private PaymentStrategy paymentStrategy;

    // 전략 주입 (런타임에 교체 가능)
    public PaymentService(PaymentStrategy paymentStrategy) {
        this.paymentStrategy = paymentStrategy;
    }

    public void processPayment(int amount) {
        paymentStrategy.pay(amount);
    }
}

```

```java
public class Main {
    public static void main(String[] args) {
        PaymentService service = new PaymentService(new CreditCardPayment());
        service.processPayment(10000);  // "10000원을 신용카드로 결제합니다."

        // 전략 교체
        service = new PaymentService(new KakaoPayPayment());
        service.processPayment(20000);  // "20000원을 카카오페이로 결제합니다."
    }
}
```

### 정리

전략 패턴은 알고리즘을 캡슐화하여 런타임에 자유롭게 교체할 수 있는 패턴이다. 이 패턴의 핵심 장점은 다음과 같다:

1. **유연성**: 클라이언트 코드 변경 없이 새로운 전략(알고리즘)을 추가하거나 기존 전략을 변경할 수 있다.
2. **캡슐화**: 클라이언트는 인터페이스만 알면 되고, 구현 세부사항은 알 필요가 없다.
3. **관심사 분리**: 알고리즘과 이를 사용하는 컨텍스트가 명확히 분리된다.

예시처럼 사용자는 `service.processPayment()`만 호출하면 되고, 내부적으로 어떤 결제 방식이 사용되는지는 몰라도 된다. 이는 OCP(Open-Closed Principle)를 잘 지키는 예로, 기존 코드 수정 없이 새로운 결제 방식을 쉽게 추가할 수 있다.

스프링에서는 아래와 같이 의존성을 주입할 수 있다. PaymentStrategy라는 인터페이스를 implement하고 있다면 Map형태로 주입받을 수 있다. 이때, 키값은 빈의 이름이 된다.
```java
@Service
public class PaymentServiceImpl implements PaymentService {

    private final PaymentRepository paymentRepository;
    private final Map<String, PaymentStrategy> paymentStrategies;

    /**
     * 결제 레포지토리와 결제 전략들을 주입하는 생성자
     * Spring이 자동으로 PaymentStrategy 타입의 모든 빈을 Map으로 주입합니다
     */
    public PaymentServiceImpl(PaymentRepository paymentRepository, Map<String, PaymentStrategy> paymentStrategies) {
        this.paymentRepository = paymentRepository;
        this.paymentStrategies = paymentStrategies;
    }
}
```
