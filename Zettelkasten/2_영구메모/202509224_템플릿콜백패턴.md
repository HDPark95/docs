# 템플릿 콜백 패턴
**ID:** 202509224_템플릿콜백패턴
**생성일:** 2025-09-21
**태그:** #디자인패턴 #Spring #콜백

## 핵심 개념

템플릿 콜백 패턴은 템플릿 메서드 패턴의 변형으로, 상속 대신 **컴포지션과 콜백**을 사용하여 알고리즘의 구조를 정의하고 특정 단계의 구현을 유연하게 변경할 수 있게 하는 패턴이다.

## 구성 요소

### 템플릿 (Template)
- 고정된 작업 흐름을 가진 메서드
- 반복되는 코드와 예외 처리, 리소스 관리 등을 담당
- 비즈니스 로직이 들어갈 부분을 콜백으로 위임

### 콜백 (Callback)
- 실행 시점에 호출되는 함수나 객체
- 템플릿 내의 특정 지점에서 실행되는 사용자 정의 로직
- 함수형 인터페이스로 구현 가능

## 패턴의 장점

### 1. 유연성
- 상속보다 유연한 구조 제공
- 런타임에 동작 변경 가능

### 2. 재사용성
- 템플릿은 재사용하면서 콜백만 교체 가능
- 코드 중복 제거

### 3. 단일 책임 원칙
- 템플릿: 흐름 제어와 공통 처리
- 콜백: 비즈니스 로직

## Spring에서의 활용

### JdbcTemplate 예제
```java
public List<User> findAll() {
    return jdbcTemplate.query(
        "SELECT id, name, email FROM users",
        (rs, rowNum) -> {  // 콜백: RowMapper
            User user = new User();
            user.setId(rs.getLong("id"));
            user.setName(rs.getString("name"));
            user.setEmail(rs.getString("email"));
            return user;
        }
    );
}
```

### TransactionTemplate 예제
```java
public User createUser(User user) {
    return transactionTemplate.execute(status -> {  // 콜백
        User savedUser = userRepository.save(user);
        if (savedUser.getId() == null) {
            status.setRollbackOnly();
            throw new RuntimeException("User creation failed");
        }
        return savedUser;
    });
}
```

## 실제 구현 패턴

```java
public class ResourceTemplate {
    public <T> T execute(String resourceName, ResourceCallback<T> callback) {
        Resource resource = null;
        try {
            resource = acquireResource(resourceName);
            return callback.doInResource(resource);
        } catch (Exception e) {
            throw new RuntimeException("Resource processing failed", e);
        } finally {
            if (resource != null) {
                releaseResource(resource);
            }
        }
    }
}

@FunctionalInterface
public interface ResourceCallback<T> {
    T doInResource(Resource resource) throws Exception;
}
```

## 관련 개념

- [[202509225_템플릿메서드패턴]] - 상속 기반의 유사한 패턴
- [[202509226_Spring콜백패턴활용]] - Spring에서의 구체적 활용 사례
- [[202509227_함수형인터페이스설계]] - 콜백 인터페이스 설계 원칙

## 결론

템플릿 콜백 패턴은 Spring Framework의 핵심 설계 원칙으로, 반복되는 코드를 제거하고 비즈니스 로직에 집중할 수 있게 해주는 강력한 패턴이다. 특히 리소스 관리와 예외 처리가 복잡한 상황에서 매우 유용하다.